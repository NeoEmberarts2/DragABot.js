<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>DragABot.js</title>

  <script src="https://codepen.io/therandomcrafter83/pen/jOWNGmN.js"></script>
  <script src="https://codepen.io/neoemberarts2/pen/NWxKPqX.js"></script>
  <script src="https://codepen.io/neoemberarts2/pen/PoZYwqm.js"></script>
  <script src="https://codepen.io/neoemberarts2/pen/mdVbyVR.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.11.0/beautify.js"></script>
  <script src="ace.js" type="text/javascript" charset="utf-8"></script>


  <style>
    body {
      background-color: #fff;
      font-family: sans-serif;
    }

    h1 {
      font-weight: normal;
      font-size: 140%;
    }
  </style>
</head>

<body>
  <!--Button and code styles-->
  <link rel="stylesheet" href="style.css">

  <style>
    /*Tooltip Setup*/
    .tooltip {
      position: relative;
      display: inline-block;
      border-bottom: 1px dotted black;
    }

    .tooltip .tooltiptext {
      visibility: hidden;
      width: 120px;
      background-color: black;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px 0;

      /* Position the tooltip */
      position: absolute;
      z-index: 1;
    }

    .tooltip:hover .tooltiptext {
      visibility: visible;
    }

    /*Compiler button*/
    .button4 {
      box-shadow: 0px 10px 14px -7px #276873;
      background: linear-gradient(to bottom, #599bb3 5%, #408c99 100%);
      background-color: #599bb3;
      border-radius: 8px;
      display: inline-block;
      cursor: pointer;
      color: #ffffff;
      font-family: Arial;
      font-size: 13px;
      font-weight: bold;
      padding: 13px 32px;
      text-decoration: none;
      text-shadow: 0px 1px 0px #3d768a;
    }

    .button4:hover {
      background: linear-gradient(to bottom, #408c99 5%, #599bb3 100%);
      background-color: #408c99;
    }

    .button4:active {
      position: relative;
      top: 1px;
    }

    /*Code Veiwer*/
    .CodeVeiw {
      box-shadow: inset 0px 1px 0px 0px #ffffff;
      background: linear-gradient(to bottom, #f9f9f9 5%, #e9e9e9 100%);
      background-color: #f9f9f9;
      border-radius: 6px;
      border: 1px solid #dcdcdc;
      display: inline-block;
      cursor: pointer;
      color: #666666;
      font-family: Arial;
      font-size: 15px;
      font-weight: bold;
      padding: 6px 24px;
      text-decoration: none;
      text-shadow: 0px 1px 0px #ffffff;
    }

    .CodeVeiw:hover {
      background: linear-gradient(to bottom, #e9e9e9 5%, #f9f9f9 100%);
      background-color: #e9e9e9;
    }

    .CodeVeiw:active {
      position: relative;
      top: 1px;
    }

    #blocklyContainer {
      position: relative;
      width: 100%;
      height: 75vh;
    }

    #blocklyDiv {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
    }

    .blocklyText text {
      cursor: default
    }

    .blocklyFlyoutButton {
      fill: #aaa;
      cursor: default;
    }

    .blocklyFlyoutButton:hover {
      fill: rgb(89, 87, 87)
    }
  </style>

  <table width="100%" height="100%">
    <tr>
      <td>

      </td>
      <td class="farSide">

      </td>
    </tr>
    <tr>
      <td colspan=2>
        <table width="100%">
          <tr id="tabRow" height="1em">
            <td id="tab_blocks" class="tabon">Blocks</td>
            <td id="tab_viewcode" class="taboff tab_collapse">Code</td>
            <td id="tab_download" class="taboff tab_collapse">Download_Code</td>

            <td id="tab_code" class="taboff">
              <select id="code_menu"></select>
            </td>
            <td class="tabmax">

            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <td height="99%" colspan=2 id="content_area">
      </td>
    </tr>
  </table>

  <div id="content_blocks" class="content"></div>

  <pre id="content_viewcode" class=""><div id="Codeveiw" class="CodeVeiw"></div></pre>
  <pre id="content_download" class=""><div id="Download" class="CodeVeiw"></div></pre>


  <section id="blocklyContainer">
    <div id="blocklyDiv"></div>
  </section>


  <!--Categories-->
  <xml xmlns="https://developers.google.com/blockly/xml" id="workspaceBlocks" style="display: none">

    <xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">
      <category name="JavaScript" colour="#FFFF00"></category>
      <sep></sep>
      <category name="Logic" colour="#C684C1">

        <block type="if" class="Logic" dir="JavaScriptBlocks">
          <field name="compare">=</field>
          <value name="statement1">
            <block type="string">
              <field name="String">String</field>
            </block>
          </value>
        </block>
        <block type="if_prefix_equals" class="Logic" dir="JavaScriptBlocks"></block>

        <block type="if_message_equals" class="Logic" dir="JavaScriptBlocks">
          <field name="NAME">===</field>
          <value name="Value">
            <block type="string">
              <field name="String">String</field>
            </block>
          </value>
        </block>

        <block type="equality" class="Logic" dir="JavaScriptBlocks"></block>

        <block type="and_or_operators" class="Logic" dir="JavaScriptBlocks"></block>
        <block type="not_operator" class="Logic" dir="JavaScriptBlocks"></block>
        <block type="boolean" class="Logic" dir="JavaScriptBlocks"></block>
        <block type="null_undefined" class="Logic" dir="JavaScriptBlocks"></block>
        <block type="test_ternary" class="Logic" dir="JavaScriptBlocks"></block>


      </category>


      <category name="Loops" colour="#5C80A5">

        <block type="repeat_loop" class="Loops" dir="JavaScriptBlocks"></block>
        <block type="while_loop" class="Loops" dir="JavaScriptBlocks"></block>
        <block type="for_loop" class="Loops" dir="JavaScriptBlocks"></block>
        <block type="for_in_loop" class="Loops" dir="JavaScriptBlocks"></block>
        <block type="for_each_loop" class="Loops" dir="JavaScriptBlocks"></block>
        <block type="break_continue" class="Loops" dir="JavaScriptBlocks"></block>

      </category>

      <category name="Math" colour="#DCDDA8">

        <block type="number" dir="JavaScriptBlocks" class="Math"></block>
        <block type="NaN" class="Math" dir="JavaScriptBlocks"></block>
        <block type="isNan" class="Math" dir="JavaScriptBlocks"></block>
        <block type="toNum" class="Math" dir="JavaScriptBlocks"></block>

        <block type="operations" dir="JavaScriptBlocks" class="Math"></block>
        <block type="basic_math_functions" dir="JavaScriptBlocks" class="Math"></block>
        <block type="trig" dir="JavaScriptBlocks" class="Math"></block>
        <block type="common_constants" dir="JavaScriptBlocks" class="Math"></block>

        <block type="number_check" dir="JavaScriptBlocks" class="Math">
          <value name="number">
            <block type="number" class="Math" dir="JavaScriptBlocks">
              <field name="Number">Number</field>
            </block>
          </value>
        </block>

        <block type="round_number" dir="JavaScriptBlocks" class="Math"></block>
        <block type="of_list" dir="JavaScriptBlocks" class="Math"></block>
        <block type="remainder_of" dir="JavaScriptBlocks" class="Math"></block>
        <block type="max_min" dir="JavaScriptBlocks" class="Math"></block>
        <block type="random_between" dir="JavaScriptBlocks" class="Math"></block>
        <block type="random" dir="JavaScriptBlocks" class="Math"></block>


      </category>

      <category name="Strings" colour="#5BA55B">

        <block type="string" dir="JavaScriptBlocks" class="Strings">
          <field name="String">String</field>
        </block>

        <block type="string_concat" dir="JavaScriptBlocks" class="Strings"></block>

        <div class="hide">
          <block type="item" dir="JavaScriptBlocks" class="Strings"></block>
        </div>

        <block type="append_string" dir="JavaScriptBlocks" class="Strings"></block>
        <block type="length" dir="JavaScriptBlocks" class="Strings"></block>
        <block type="indexOf_string" dir="JavaScriptBlocks" class="Strings">

          <value name="index">
            <block type="string" class="Strings" dir="JavaScriptBlocks">
              <field name="index">String</field>
            </block>
          </value>

          <value name="from">
            <block type="number" class="Math" dir="JavaScriptBlocks">
              <field name="from">0</field>
            </block>
          </value>

          <value name="find">
            <block type="string" class="Strings" dir="JavaScriptBlocks">
              <field name="find">String</field>
            </block>
          </value>

        </block>

        <block type="charAt" dir="JavaScriptBlocks" class="Strings"></block>
        <block type="substring" dir="JavaScriptBlocks" class="Strings"></block>
        <block type="toBlankCase" dir="JavaScriptBlocks" class="Strings"></block>
        <block type="trim" dir="JavaScriptBlocks" class="Strings"></block>
        <block type="consoleLog" dir="JavaScriptBlocks" class="Strings"></block>


      </category>

      <category name="Lists" colour="#745BA5">
        <block type="listCreateWith" dir="JavaScriptBlocks" class="Lists"></block>
        <block type="repeatedList" dir="JavaScriptBlocks" class="Lists"></block>
        <block type="listLength" dir="JavaScriptBlocks" class="Lists"></block>
        <block type="listEmpty" dir="JavaScriptBlocks" class="Lists"></block>
        <block type="listIndex" dir="JavaScriptBlocks" class="Lists"></block>
        <block type="listGetIndex" dir="JavaScriptBlocks" class="Lists"></block>
        <block type="listSetIndex" dir="JavaScriptBlocks" class="Lists"></block>
        <block type="listSubList" dir="JavaScriptBlocks" class="Lists"></block>
        <block type="listSort" dir="JavaScriptBlocks" class="Lists"></block>
        <block type="listSort" dir="JavaScriptBlocks" class="Lists"></block>
        <block type="listJoinOrSplit" dir="JavaScriptBlocks" class="Lists"></block>
        <block type="listReverse" dir="JavaScriptBlocks" class="Lists"></block>

      </category>

      <category name="Objects" colour="#00820f">

        <block type="createNewObject" dir="JavaScriptBlocks" class="Objects"></block>

        <block type="Key-Value-Pair" dir="JavaScriptBlocks" class="Objects"></block>

      </category>


      <category name="Color" colour="#FF0000">
        <block type="colorPicker" dir="JavaScriptBlocks" class="Color"></block>
        <block type="colorRandom" dir="JavaScriptBlocks" class="Color"></block>
        <block type="colorRGB" dir="JavaScriptBlocks" class="Color"></block>
        <block type="colorHex" dir="JavaScriptBlocks" class="Color"></block>

      </category>

      <category name="Variables" colour="#549AD8">

        <button text="Create a new variable" callbackkey="mum"></button>
        <block type="getVar" dir="JavaScriptBlocks" class="Variables"></block>
        <block type="setVar" dir="JavaScriptBlocks" class="Variables"></block>


      </category>

      <category name="Functions" colour="#E7B500">


        <block type="createReturnFunc" dir="JavaScriptBlocks" class="Functions"></block>
        <block type="createVoidFunc" dir="JavaScriptBlocks" class="Functions"></block>
        <block type="ifReturn" dir="JavaScriptBlocks" class="Functions"></block>
        <block type="callVoid" dir="JavaScriptBlocks" class="Functions"></block>
        <block type="callReturn" dir="JavaScriptBlocks" class="Functions"></block>

      </category>

      <sep></sep>
      <sep></sep>

      <category name="Discord" colour="#6A7FC8"></category>
      <sep></sep>


      <category name="Settings" colour="#63E2BD">

        <block type="ignore__bots" class="Settings" dir="DiscordBlocks">
          <field name="NAME">if(msg.author.bot) return;</field>
        </block>
        <block type="set_prefix" class="Settings" dir="DiscordBlocks">
          <value name="prefix">
            <block type="string">
              <field name="String">String</field>
            </block>
          </value>
        </block>
        <block type="set_activity" id="e5YU#,~{^x*^%)i|f|j6" x="-113" y="88" class="Settings" dir="DiscordBlocks">
          <value name="Activity">
            <block type="string" id="qVLf{2FOwgey1oU$y1vE">
              <field name="String">Minecraft</field>
            </block>
          </value>
        </block>


      </category>

      <category name="Actions" colour="#67964F">

        <block type="send_message" class="Actions" dir="DiscordBlocks">
          <field name="NAME">msg.channel.send(</field>
          <value name="NAME">
            <block type="string">
              <field name="String">String</field>
            </block>
          </value>
        </block>
        <block type="send_embed" class="Actions" dir="DiscordBlocks">
          <field name="NAME">0</field>
          <value name="Title">
            <block type="string">
              <field name="String">Title</field>
            </block>
          </value>
          <value name="Descriptioon">
            <block type="string">
              <field name="String">Description</field>
            </block>
          </value>
        </block>
        <block type="delete_message" class="Actions" dir="DiscordBlocks"></block>


      </category>
      <category name="Events" colour="#FF8081">

        <block type="on_message" class="Events" dir="DiscordBlocks"></block>

      </category>

      <category name="Data" colour="#5b67a5">

        <block type="message" dir="DiscordBlocks" class="Data">
          <field name="NAME">.replaceAll(prefix,"")</field>
        </block>

        <block type="get_user" dir="DiscordBlocks" class="Data">
          <field name="NAME">msg.author</field>
        </block>

        <block type="prefix" dir="DiscordBlocks" class="Data"></block>


      </category>

      <category name="Client data" colour="#9fa55b">

        <block type="client_login" class="ClientData" dir="DiscordBlocks">
          <field name="Token">Paste token here</field>
        </block>

      </category>

      <sep></sep>

      </category>
      <sep></sep>


    </xml>
  </xml>


  <div class="tooltip">
    <a onClick="this.setSelectionRange(0, this.value.length)" id="CodeText" class="CodeVeiw">Please click "show code" to see or download your code</a>

    <span class="tooltiptext">Click the code to download it</span>
  </div>


  <script>
    $(document).ready(function () {
      setTimeout(() => {
        Blockly.getMainWorkspace().registerButtonCallback("mum", function (button) {
          console.log(1)
          Blockly.Variables.createVariableButtonHandler(button.getTargetWorkspace(), null, "name");

        });
      }, 200);
    })
  </script>
  <script>

    "use strict"

    function getBlock(blockName) {
      console.log(Blockly.Blocks[blockName].init.toString())
      console.log(Blockly.JavaScript[blockName].toString())

    }

    function include(file) {

      var script = document.createElement('script');
      script.src = file;
      script.type = 'text/javascript';
      script.defer = true;

      document.getElementsByTagName('head').item(0).appendChild(script);

    }

    let JSblocks = document.querySelectorAll("[dir=JavaScriptBlocks]");
    let Discblocks = document.querySelectorAll("[dir=DiscordBlocks]");

    for (let file of Object.values(JSblocks).concat(Object.values(Discblocks))) {
      let fileName = file.getAttribute("type");
      let classDir = file.getAttribute("class");
      let dir = file.getAttribute("dir");
      if (!dir || !classDir || !fileName) continue

      include('BlocklyBlocks/' + dir + "/" + classDir + '/' + fileName + ".js");

    }

    function download(text, name, type) {
      var a = document.getElementById("CodeText");
      var file = new Blob([text], {type: type});
      a.href = URL.createObjectURL(file);
      a.download = name;
    }


    var demoWorkspace = Blockly.inject('blocklyDiv',
      {
        media: '../../media/',
        toolbox: document.getElementById('toolbox')
      });
    Blockly.Xml.domToWorkspace(document.getElementById('startBlocks'),
      demoWorkspace);

    function showCode() {

      // Generate JavaScript code and display it.
      Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
      var code = Blockly.JavaScript.workspaceToCode(demoWorkspace);
      //Download
      var code2 = code;

      if (code2.indexOf("values.push(") > -1) {
        code2 = "var index3 = \"\";\nfunction getMapData(id, key) {\n    index3 = window[id + \"keys\"].indexOf(key);\n        if (index3 == -1) {\n            return \"null\";\n        } else {\n            return window[id + \"values\"][index3];\n    }\n};" + code2;
        for (var i = 0; i < mapIDs.length; i++) {
          code2 = "var " + mapIDs[i] + "keys = [\"empty\"];\n" + code2;
          code2 = "var " + mapIDs[i] + "values = [\"empty\"];\n" + code2;
        }
      }


      document.getElementById("CodeText").innerHTML = js_beautify("const Discord = require(\'discord.js\'); const client = new Discord.Client();" + code2).replace(new RegExp(String.fromCharCode(10), "gmi"), "<br>", {indent_size: 4, space_in_empty_paren: true});

      download("const Discord = require(\'discord.js\'); \nconst client = new Discord.Client();\n" + js_beautify(code2), 'BotCode.txt', 'text/plain');

    }
  </script>

  <script src="tabs.js">
  </script>


</body>

</html>